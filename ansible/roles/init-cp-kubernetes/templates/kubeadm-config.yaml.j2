apiVersion: kubeadm.k8s.io/v1beta4
kind: ClusterConfiguration
controlPlaneEndpoint: "{{ controlplane_endpoint }}"
networking:
  podSubnet: "{{ pod_network_cidr }}"
{% if (etcd_mode | default('stacked')) == 'external' %}
etcd:
  external:
    endpoints:
{% for host in groups['k8s-cp'] %}
      - https://{{ hostvars[host]['ansible_host'] }}:2379
{% endfor %}
    caFile: "{{ etcd_pki_dir }}/ca.crt"
    certFile: "{{ etcd_client_cert }}"
    keyFile: "{{ etcd_client_key }}"
{% endif %}
